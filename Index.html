<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
   <script>
   
//    window.onload = function() { 
//        createTable([["row 1, cell 1", "row 1, cell 2"], ["row 2, cell 1", "row 2, cell 2"]]);
//    };
   
   
    function doAThing(data) {
      console.log("a thing was done");
      document.getElementById('test').innerHTML = data;
    }
    
    function showTableItem(row, col){
        var text = document.getElementById("itemTable").rows[row].cells[col].innerHTML;
        document.getElementById("test").innerHTML = text;
    }
    
    
    
    function createTable(tableData) {
        var table = document.createElement('table');
        table.setAttribute("id", "itemTable");
        var tableBody = document.createElement('tbody');
        
        tableData.forEach(function(rowData) {
            var row = document.createElement('tr');
            
            var count = 0;
            rowData.forEach(function(cellData) {
                var cell = document.createElement('td');
                
                if(count == 1) {
                    var btn = document.createElement("BUTTON");
                    var t = document.createTextNode(cellData);
                    btn.appendChild(t);
                    cell.appendChild(btn);
                } else {
                    
                    var t = document.createTextNode(cellData);
                    cell.appendChild(t);
                }
                

                row.appendChild(cell);
                count++;
            });
            tableBody.appendChild(row);
        });
        table.appendChild(tableBody);
        document.getElementById("tableContainer").innerHTML = "";
        document.getElementById("tableContainer").appendChild(table);
        
        console.log("successfully created table");
    }
    //



  </script>
  </head>
  
  <body>
    <div id="container" class="container">
     <input type="button" value="Create Table" 
          onClick="google.script.run.withSuccessHandler(createTable).getDataTest('A1:B4')"/> &ensp;
      <br>
      <input type="button" value="Item ref test"
          onClick="javascript:showTableItem(2,0);"/> &ensp;
      <br>
      ..........
      <br>
      <div id="tableContainer">Table will go here</div>
      <br>
      
      <div id = "test"> nothing to see here... </div>
    </div>
  </body>
  
  
  
  
  <style>
    /* resize content/add border */
   .container {
      width: 95%;
/*      height: 100%; /* not sure why this doesn't have an affect */
      height: 675px;
      border: 4px double grey;
      border-radius: 15px;
      padding: 10px;
    }
  </style>
</html>